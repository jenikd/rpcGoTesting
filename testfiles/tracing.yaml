ignore: false

deploy:
  - contract_id: 1
    # contract located in contracts/tracing/store.sol
    abi: '[{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"num","type":"uint256"}],"name":"TestLog","type":"event"},{"inputs":[],"name":"retrieve","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"num","type":"uint256"}],"name":"store","outputs":[],"stateMutability":"nonpayable","type":"function"}]'
    bytecode: 0x6080604052348015600e575f5ffd5b506101968061001c5f395ff3fe608060405234801561000f575f5ffd5b5060043610610034575f3560e01c80632e64cec1146100385780636057361d14610056575b5f5ffd5b610040610072565b60405161004d91906100c8565b60405180910390f35b610070600480360381019061006b919061010f565b61007a565b005b5f5f54905090565b805f81905550807fc9a2166775dcce465c3dc43d6ad4e991fef0c0cb017ad4533430a332a10276f960405160405180910390a250565b5f819050919050565b6100c2816100b0565b82525050565b5f6020820190506100db5f8301846100b9565b92915050565b5f5ffd5b6100ee816100b0565b81146100f8575f5ffd5b50565b5f81359050610109816100e5565b92915050565b5f60208284031215610124576101236100e1565b5b5f610131848285016100fb565b9150509291505056fea264697066735822122058ec66aba150b4d9096c63388fc4cb436c9bcb4b6322617e0170da955b7e7b5564736f6c637828302e382e32392d646576656c6f702e323032342e31312e312b636f6d6d69742e66636130626433310059

  - contract_id: 2
    # contract located in contracts/tracing/innercall.sol
    abi: '[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"string","name":"message","type":"string"}],"name":"Log","type":"event"},{"inputs":[{"internalType":"uint256","name":"_num","type":"uint256"}],"name":"InnerCall","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"bContract","outputs":[{"internalType":"contract B","name":"","type":"address"}],"stateMutability":"view","type":"function"}]'
    bytecode: 0x6080604052348015600e575f5ffd5b506040516019906074565b604051809103905ff0801580156031573d5f5f3e3d5ffd5b505f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506081565b6101bf8061032683390190565b6102988061008e5f395ff3fe608060405260043610610028575f3560e01c806378e43df31461002c578063f2e06b5014610056575b5f5ffd5b348015610037575f5ffd5b50610040610072565b60405161004d9190610199565b60405180910390f35b610070600480360381019061006b91906101e9565b610096565b005b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16636466414b826040518263ffffffff1660e01b81526004016100ef9190610223565b5f604051808303815f87803b158015610106575f5ffd5b505af1158015610118573d5f5f3e3d5ffd5b5050505050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f819050919050565b5f61016161015c6101578461011f565b61013e565b61011f565b9050919050565b5f61017282610147565b9050919050565b5f61018382610168565b9050919050565b61019381610179565b82525050565b5f6020820190506101ac5f83018461018a565b92915050565b5f5ffd5b5f819050919050565b6101c8816101b6565b81146101d2575f5ffd5b50565b5f813590506101e3816101bf565b92915050565b5f602082840312156101fe576101fd6101b2565b5b5f61020b848285016101d5565b91505092915050565b61021d816101b6565b82525050565b5f6020820190506102365f830184610214565b9291505056fea264697066735822122029e33b66c31885d415e851390115ff0d7efe99bc06ccf3dd112464622d42566b64736f6c637828302e382e32392d646576656c6f702e323032342e31312e312b636f6d6d69742e666361306264333100596080604052348015600e575f5ffd5b506101a38061001c5f395ff3fe608060405260043610610033575f3560e01c80634e70b1dc146100375780636466414b1461006157806367e0badb1461007d575b5f5ffd5b348015610042575f5ffd5b5061004b6100a7565b60405161005891906100d5565b60405180910390f35b61007b6004803603810190610076919061011c565b6100ac565b005b348015610088575f5ffd5b506100916100b5565b60405161009e91906100d5565b60405180910390f35b5f5481565b805f8190555050565b5f5f54905090565b5f819050919050565b6100cf816100bd565b82525050565b5f6020820190506100e85f8301846100c6565b92915050565b5f5ffd5b6100fb816100bd565b8114610105575f5ffd5b50565b5f81359050610116816100f2565b92915050565b5f60208284031215610131576101306100ee565b5b5f61013e84828501610108565b9150509291505056fea2646970667358221220cc9c1c04dd942f20d3f0c5cfb7493d38b054ca66b1adee74be7c068c67d59b4264736f6c637828302e382e32392d646576656c6f702e323032342e31312e312b636f6d6d69742e66636130626433310059

contract_call:
  - call_id: 1
    contract_id: 1
    method_name: store
    arguments: [42]

  - call_id: 2
    contract_id: 2
    method_name: InnerCall
    arguments: [23]

test_call:

  - test_name: "Check trace"
    call_id: 1
    method_name: trace_transaction
    arguments: [tx.hash]
    result: [{"action":{"callType":"call","from":"0x239fa7623354ec26520de878b52f13fe84b06971","gas":"0x7a1200","input":"0x6057361d000000000000000000000000000000000000000000000000000000000000002a","to":"0xf8ee8d1730d3936094ebb04d2cd4a44b34d00cbc","value":"0x0"},"blockHash":"0x000003b800000025919264650896870f7829d6de4c87a53d973417d9b35b82b3","blockNumber":58487,"result":{"gasUsed":"0xcceb7","output":"0x"},"subtraces":0,"traceAddress":[],"transactionHash":"0x1d25a589a6343fa4de1a174a451d5e0276de8976a155dad8d01308c979dbc599","transactionPosition":0,"type":"call"}]
    ignore_fields: ["to",  "gas","gasUsed","blockNumber", "blockHash", "transactionHash", "transactionPosition", "traceAddress"]

  - test_name: "Check trace 2"
    call_id: 2
    method_name: trace_transaction
    arguments: [tx.hash]
    result: [ { "action": { "callType": "call", "from": "0x239fa7623354ec26520de878b52f13fe84b06971", "to": "0x6f174b880a2494536b1f788bd97104a988b52e82", "value": "0x0", "gas": "0xc174", "input": "0xf2e06b500000000000000000000000000000000000000000000000000000000000000017" }, "blockHash": "0x000004850000005420673747487473571a19be806e2b32f06aec30dcc5d7904f", "blockNumber": 63501, "result": { "gasUsed": "0xc058", "output": "0x" }, "subtraces": 1, "traceAddress": [], "transactionHash": "0xad37eccdaef1f5c5c694ab257c7e733ec887451c4724faac5c8e5e52bc5ea8b0", "transactionPosition": 0, "type": "call" }, { "action": { "callType": "call", "from": "0x6f174b880a2494536b1f788bd97104a988b52e82", "to": "0x3c44e34b55609ce61a49a7459552b99ee451646d", "value": "0x0", "gas": "0x57e0", "input": "0x6466414b0000000000000000000000000000000000000000000000000000000000000017" }, "blockHash": "0x000004850000005420673747487473571a19be806e2b32f06aec30dcc5d7904f", "blockNumber": 63501, "result": { "gasUsed": "0x57e0", "output": "0x" }, "subtraces": 0, "traceAddress": [ 0 ], "transactionHash": "0xad37eccdaef1f5c5c694ab257c7e733ec887451c4724faac5c8e5e52bc5ea8b0", "transactionPosition": 0, "type": "call" } ]
    ignore_fields: ["from", "to", "gas","gasUsed", "blockNumber", "blockHash", "transactionHash", "transactionPosition", "traceAddress"]